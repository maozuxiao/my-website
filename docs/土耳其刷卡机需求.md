# 土耳其刷卡机需求

> [!NOTE]
>
> 增加背景说，参考RDMS
>

[TOC]

## Revision History

| 日期       | 版本号 | 说明     |
| ---------- | ------ | -------- |
| 2025-12-16 | V1.0   | 新建文档 |




## 3864（471）客户-公交项目需求汇总


### 概述

#### 背景

3864客户曾是海外第一大客户，总部位于土耳其Izmir，是专注于全球的刷卡机业务和公交相关业务的公司，专业化程度非常高；该公司最早于2012年即开始与锐明合作，与公司产生了深厚的联系；3864客户于2018年后因自身发展原因和锐明合作减少，但自2022年开始，公交相关业务和整合需求不断导入锐明，ITxPT联调、刷卡机、公交基础监控等需求不断更新，客户也在持续下单设备，有逐渐恢复全面合作的趋势

#### 系统组成

#### 引用文件

### 功能需求


## 3864（471）客户-公交项目需求汇总


### 概述

#### 背景

3864客户曾是海外第一大客户，总部位于土耳其Izmir，是专注于全球的刷卡机业务和公交相关业务的公司，专业化程度非常高；该公司最早于2012年即开始与锐明合作，与公司产生了深厚的联系；3864客户于2018年后因自身发展原因和锐明合作减少，但自2022年开始，公交相关业务和整合需求不断导入锐明，ITxPT联调、刷卡机、公交基础监控等需求不断更新，客户也在持续下单设备，有逐渐恢复全面合作的趋势

#### 系统组成

| 产品 |     名称     | 软件路径                                                     | 备注                           |
| :--: | :----------: | ------------------------------------------------------------ | ------------------------------ |
| MDVR |   A8PRO2.0   | **软件名称**：BUS_A8PRO2.0_M04.1029_V359_1029_B242_RC25091560<br />**路径**：[企业内容库\STREAMAX\STREAMAX 锐明技术\Product Department产品发展中心\Public Transportation-公交产品线\外部文件External\软件发布\8系列主机\A8ProV2.0\3914\国标](https://wj.streamax.com:9443/index.html#doc/enterprise/918572) | A8PRO2.0所有子机型都用一个版本 |
|  :   | X7NPRO-H0416 | **软件名称**：ST_X7N_M04.1029_V3.5.6.9_R24103001<br />**路径**：[企业内容库\STREAMAX\STREAMAX 锐明技术\Product Department产品发展中心\校车警用产品线（School bus&Police）\校车 School Bus\软件版本\客户定制版本\欧洲\3914(1029)\X7NPRO-H0416](https://wj.streamax.com:9443/index.html#doc/enterprise/198986) |                                |
|  :   |  X3N-H0208   |                                                              | 待支持                         |
|  :   | A16MAX(IBCU) |                                                              | 待支持                         |
|  :   | X7NPRO-H1608 |                                                              | 待支持                         |

#### 引用文件

> * 471客户需求文档（V2.4）2025-05-08.docx

### 功能需求

#### 语言需求

> 语言要求为土耳其语 、英文，**默认语言为土耳其语**_~Rd~_
>
> 

#### TCP端口说明

> 在N9M设备上，本地网口TCP通信端口固定`65500`

#### 支持刷卡信息的OSD叠加

> [!CAUTION]
>
> 一个版本支持2个不同客户的OSD，会根据对应客户发送的协议显示对应客户的OSD，因此不会存在冲突，无需使用额外的开关进行控制

#### 显示要求

> [!NOTE]
>
> -	由3行叠加变成5行叠加；为了让客户的刷卡兼容新老MDVR，所以客户可以选择发送3行或者5行，但是必须为其中之一 （如下显示需求中文部分已经修改为5行描述，因为目前对接的机型可认定为新MDVR）
> -	支持长显示，即直到下一次更新位置，OSD一直不消失，在ROW开头加#作为长显示标识
>   ![IP & Port](https://cdn.jsdelivr.net/gh/maozuxiao/Misaki/image-20251216105137672.png#40%)

_^Tab^_

> **显示要求**
>
> * 数据包包含**五行**文本，每行由 20 个 ASCII 字符（即 20 字节）组成。
>
> * 数据包包含一个校验字节，该字节通过对所有行中全部字节进行异或（XOR）运算生成。
>
> * 数据包使用 STX（起始字符）和 ETX（结束字符）进行封装，用于标识数据包的开始与结束。
>
> * 发送的每条刷卡信息叠加在录像码流，显示2秒后消失，回放显示在左上角；如果在2秒内收到多条刷卡信息，则叠加最新的刷卡信息。
>
> * 支持录像中OSD叠加的位置的配置。
>
> * 5行字符串的显示要求同步刷新。
>
> * 网传码流增加刷卡信息OSD叠加
>
> * 可以对特定通道开启/关闭OSD的叠加，对字体类型、字号、颜色或文本位置无特殊要求，可按以下固定方式处理：
>
>   - **字体颜色**：背景色为黑色，前景色（文字颜色）为红色。
>   - **字体类型与字号**：可自行选择，但必须确保文字清晰易读。
>   - **文本位置**：假设视频画面边框为黑色区域，文字显示区域为红色区域；**五行文本**应置于视频画面的**右上角**。
>
>   ![待确认](D:\Typora pictures\土耳其刷卡机需求\image-20251216105428046.png#40%)
>
>   
>
> 

> **客户原文**
>
> There are three rows which each one includes 20 ascii chars (20 bytes). 
>
> There is also one byte checksum which generated from XOR of all bytes of rows. 
>
> There are also STX and ETX which encapsulates the package and informs the start and the end of the package. 
>
> There is nothing about font type, font size, color or text location. These can be fixed like below. 
>
> For font color : background color can be black and foreground color (text color) can be red.
>
> For font type, font size : it is up to you, but it must be readable easily. 
>
> For text location: suppose the black one is the video frame border. The red one is the text area. Please place the three rows at the top right of the video like below. 
>
> 
>
> When a text message sends, it will be shown for 2 seconds on the video and then it will disappear. But if a new message sends, it will be shown immediately without waiting 2 seconds for previous one.

#### 叠加协议

TCP connection. Port number : any port . it is up to you. 

```TCP
Response is 1 byte. 
For success return 0x06, for failure return 0x15. 
---------------------------------------------------
TCP connection. Port number : 65500
Package contains ->[ STX | ROW1 | ROW2 | ROW3| *ROW4|*ROW5  | LRC | ETX ]
STX : start of transmission. 0x02. 1 byte
ROW(#):ascii 20 chars fixed. 20 byte each row.  Example : “123456789abcdef     ”, “     12345     12345     ” etc ... empty char will be 0x20 space char. Not null char like 0x00
LRC: 1 byte checksum. Xor of total of all rows (ROW1 + ROW2 + ROW3+ ROW4 + ROW5). 100 bytes.
ETX : end of transmission. 0x03. 1 byte
Total package byte is : 1 + 20 + 20 + 20 + 20 + 20 + 1 + 1 = 103 bytes
```

#### 单独控制OSD叠加通道






------

## 3914-ASIS客户-刷卡城市国标项目需求


### 概述

#### 背景


#### 系统组成

#### 引用文件

### 功能需求